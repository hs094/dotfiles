title = "Production Gitleaks Configuration"
description = "High-signal Gitleaks configuration for scanning all files including ignored ones when used with --no-git."

# ---------------------------------------------------
# GLOBAL ALLOWLIST (tight, intentional)
# ---------------------------------------------------
[allowlist]
description = "Paths and patterns intentionally excluded"

# Only exclude things that should NEVER contain secrets
paths = [
  '''^vendor/''',
  '''^node_modules/''',
  '''^dist/''',
  '''^build/''',
  '''^\\.git/''',
  '''^coverage/''',
  '''^\\.next/''',
]

# Allow known placeholder values (important for templates)
regexes = [
  '''(?i)example(_|-)?(key|token|secret)''',
  '''(?i)your_(api|secret|token)_here''',
  '''(?i)changeme''',
  '''(?i)dummy(_|-)?(key|token|secret)'''
]

# ---------------------------------------------------
# CORE SECRET RULES
# ---------------------------------------------------

[[rules]]
id = "generic-secret"
description = "Generic high-entropy secret assignment"
regex = '''(?i)(api|auth|access|secret|token|key|password)[^=\n]{0,20}=[^=\n]{20,}'''
entropy = 3.5
keywords = ["secret", "token", "key", "password"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|access).{0,20}=[0-9a-zA-Z/+]{40}'''
entropy = 4.5

[[rules]]
id = "jwt-token"
description = "JWT token"
regex = '''eyJ[A-Za-z0-9_-]+\\.eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+'''

[[rules]]
id = "private-key"
description = "Private key blocks"
regex = '''-----BEGIN (RSA|EC|DSA|OPENSSH|PGP) PRIVATE KEY-----'''

# ---------------------------------------------------
# ENV FILES â€” EXPLICITLY INCLUDED
# ---------------------------------------------------

[[rules]]
id = "env-files-secrets"
description = "Secrets inside env and env.example files"
path = '''\\.env(\\.example|\\.local|\\.prod|\\.dev)?$'''
regex = '''(?i)(api|secret|token|key|password)[^=\n]*=[^=\n]{12,}'''
entropy = 3.0

